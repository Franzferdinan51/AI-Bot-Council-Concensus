# Repository Guidelines

## Project Structure & Module Organization
- `src/index.ts` boots the MCP server, registers council tools, and wires transports.
- `src/services/` holds AI provider selection, orchestration, session persistence, and error handling; `src/utils/` keeps shared helpers.
- `src/tools/` defines council session, auto-mode, and management tools; `src/types/` centralizes constants and shared interfaces.
- `examples/` contains usage patterns; `dist/` is generated by the TypeScript build; `start.bat`/`start.sh` drive interactive startup and checks.
- Use `.env.example` as the template for local secrets; never commit `.env`.

## Build, Test, and Development Commands
- `npm install` – install dependencies.
- `npm run dev` – watch-and-run via `tsx`; fastest feedback while editing `src/**/*`.
- `npm run build` – compile TypeScript to `dist/` for release or `npm run start`.
- `npm run start` – run the built server from `dist/index.js`; ensure `npm run build` first.
- `npm run typecheck` – strict type pass without emit; run before PRs.
- `npm run check` or `./start.sh -c` – smoke check of the interactive menu (bash required; on Windows prefer `start.bat`).

## Coding Style & Naming Conventions
- TypeScript ES modules, 2-space indent, single quotes, trailing semicolons; keep imports ordered from libs to locals.
- Prefer explicit return types on exported functions/classes; keep shared types in `src/types`.
- Co-locate helpers in `src/utils`; favor pure functions.
- Use `zod` for input validation and `DEFAULT_SETTINGS` for provider defaults instead of ad-hoc literals.
- Naming: PascalCase for classes (e.g., `CouncilOrchestrator`), camelCase for functions/vars (`sessionService`), kebab-case for files when adding new modules to match existing patterns.

## Testing Guidelines
- No automated test suite yet; rely on `npm run typecheck` and interactive smoke tests (`npm run start` or `start.bat` choose a mode and run a short session).
- When adding tests, mirror source layout (e.g., `src/services/__tests__/councilOrchestrator.spec.ts`) and cover provider selection, session lifecycle, and tool argument validation.
- Keep fixtures lightweight; mock network calls to external model providers.

## Commit & Pull Request Guidelines
- Use clear, imperative subjects (e.g., `feat: add pause/resume tool`, `fix: guard missing sessionId`).
- Include what changed and why in the body; link issues or tickets.
- Before opening a PR: `npm run typecheck`, `npm run build`, and a manual session smoke test; note env keys used.
- PR description should list commands run, any config changes, and screenshots/log snippets for interactive flows.

## Security & Configuration Tips
- Keep API keys in `.env` or environment variables only; scope keys to least privilege and rotate regularly.
- Avoid logging secrets; prefer redaction in new diagnostics.
- For local overrides, copy `.env.example` and adjust `MAX_CONCURRENT_REQUESTS`, model endpoints, and economy mode instead of editing checked-in defaults.
